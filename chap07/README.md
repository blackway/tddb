# 6장 테스트 코드의 구성

>상황, 테스트 코드의 구성 요소, 외부 상활과 외부 결과.

1.회부 상태가 테스트 결과에 영향을 주지 않게 하기.




# 7장 대역

> 대역(다른 사람이 역할을 대신 맡아서 하는 일을 말한다.)의 필요성
- 테스트를 작성하다 보면 외부 요인이 필요한 시점이 있다. 다음은 외부 요인이 테스트에 관혀하는 주요 예이다.

1.테스트 대상에서 파일 시스템을 사용.

2.테스트 대상에서 DB로 부터 데이터를 조회 하거나 데이터를 추가. 

3.데스트 대상에서 외부의 HTTP 서버와 통신.



> Double

```
    영어로 된 테스트 관련 글을 읽으면 test double 이란 표현이 자주 나오는데 여기서
    double은 본 장에서 설명 하는 대역에 해당한다. 즉, test double은 테스트에서 진짜
    대신 사용할 대역을 의미 한다.
```

> 클래스별 용도

1.AutoDebitRegister 자동이체 등록 기능을 구현했고 CardNumberValidator(http 대역) 는 외부 api 를 시용해서 카드
    번호가 유효한지 확인 한다.
2.StubCardNumberValidator 실제 카드번호 검증 기능을 구현하지 않는다. 대신 단순한 구현(AutoDebitRegister_Stub_Test)을 대체 한다. 

3.MemoryAutoDebitInfoRepository DB 대신 맵을 이용해서 자동 이체 정보를 저장 한다. 메모리에만 데이터가 저장되므로, 테스트에 사용할 수 있다.

> 대역의 종류

-스텁(Stub) : 구현을 단순한 것으로 대체 한다. 테스트에 맞게 단순히 원하는 동작을 수행한다.
    StubCardNumberValidator 가 스텁 대역에 해당한다.

-가짜(Fake) : 제품에는 적합하지 않지만, 실제 동작하는 구현을 제공한다. DB 대신에 메모리를 이용해서 구현한 MemoryAutoDebitInfoRepository 가 가짜 대역에 해당한다.

-스파일(Spy) : 호출된 내역을 기록한다. 기록한 내용은 테스트 결과를 검증할 때 사용한다.

-모의(Mock) : 기대한 대로 상호작용하는지 행위를 검증한다. 기대한 대로 동작하지 않으면 
    익셉션을 발생할 수 있다. 모의 객체는 스텁이자 스파이도 된다.


